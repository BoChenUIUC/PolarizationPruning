#!/usr/bin/python

import numpy as np
import matplotlib
matplotlib.use('Agg')
import matplotlib.pyplot as plt
import os
labelsize_b = 13
linewidth = 2
plt.rcParams['xtick.labelsize'] = 16
plt.rcParams['ytick.labelsize'] = 16
plt.rcParams["font.family"] = "Times New Roman"
colors = ['#DB1F48','#FF9636','#1C4670','#9D5FFB','#21B6A8','#D65780']
markers = ['o','P','s','>','D','^']


def line_plot(XX,YY,label,color,path,xlabel,ylabel,lbsize=labelsize_b,lfsize=labelsize_b,legloc='best',
				xticks=None,yticks=None,ncol=None, yerr=None,
				use_arrow=False,arrow_coord=(0.4,30)):
	fig, ax = plt.subplots()
	ax.grid(zorder=0)
	for i in range(len(XX)):
		xx,yy = XX[i],YY[i]
		if yerr is None:
			plt.plot(xx, yy, color = color[i], marker = markers[i], 
				# linestyle = linestyles[i], 
				label = label[i], 
				linewidth=2, markersize=8)
		else:
			plt.errorbar(xx, yy, yerr=yerr[i], color = color[i], 
				marker = markers[i], label = label[i], 
				linewidth=2, markersize=8)
	plt.xlabel(xlabel, fontsize = lbsize)
	plt.ylabel(ylabel, fontsize = lbsize)
	if xticks is not None:
		plt.xticks(xticks,fontsize=lfsize)
	if yticks is not None:
		plt.yticks(yticks,fontsize=lfsize)
	if use_arrow:
		ax.text(
		    arrow_coord[0], arrow_coord[1], "Better", ha="center", va="center", rotation=-45, size=lbsize-8,
		    bbox=dict(boxstyle="larrow,pad=0.3", fc="white", ec="black", lw=2))
	plt.tight_layout()
	if ncol!=0:
		if ncol is None:
			plt.legend(loc=legloc,fontsize = lfsize)
		else:
			plt.legend(loc=legloc,fontsize = lfsize,ncol=ncol)
	# plt.xlim((0.8,3.2))
	# plt.ylim((-40,90))
	plt.tight_layout()
	fig.savefig(path,bbox_inches='tight')
	plt.close()

x = [[0.1*i for i in range(1,10)] for _ in range(3)]
y = [[0.10286601632833481, 0.5390719175338745, 0.8344619870185852, 0.911393940448761, 0.9336099624633789, 0.9394559860229492, 0.9403420686721802, 0.9405380487442017, 0.9405380487442017], [0.10452401638031006, 0.4070579409599304, 0.6651359796524048, 0.7920659780502319, 0.8578199148178101, 0.8995599746704102, 0.9189940690994263, 0.9319100379943848, 0.9357859492301941], [0.11322401463985443, 0.6181179881095886, 0.8571680188179016, 0.9181960225105286, 0.9356400370597839, 0.940060019493103, 0.9410279989242554, 0.9410279989242554, 0.9410279989242554]]
yerr = [[0.002733248518779874, 0.02461308240890503, 0.01103442907333374, 0.009810970164835453, 0.00689014233648777, 0.002314268611371517, 0.001483639352954924, 0.00117053824942559, 0.00117053824942559], [0.0052833459340035915, 0.04242616519331932, 0.03385111317038536, 0.027212493121623993, 0.021590324118733406, 0.0148468017578125, 0.008772843517363071, 0.006255739834159613, 0.004351438954472542], [0.007508941926062107, 0.022326674312353134, 0.01010508555918932, 0.008913583122193813, 0.005452818237245083, 0.001438929233700037, 0.00021600723266601562, 0.00021600723266601562, 0.00021600723266601562]]
line_plot(x, y,['Ours','No replica','Optimal'],colors,
		'/home/bo/Dropbox/Research/SIGCOMM23/images/FCC_ea.eps',
		'Deadline','Effective Top1 Accuracy (%)',
		yerr=yerr)	
y = [[0.9965600000000002, 0.47752000000000006, 0.12632, 0.03463999999999999, 0.008400000000000008, 0.0013600000000000057, 0.0003199999999999981, 8.00000000000023e-05, 8.00000000000023e-05], [0.9946400000000001, 0.6348800000000001, 0.32736, 0.17695999999999998, 0.09879999999999999, 0.04919999999999998, 0.026240000000000006, 0.01080000000000001, 0.00616000000000001], [0.98424, 0.38408, 0.09968000000000002, 0.027359999999999995, 0.006400000000000017, 0.0012000000000000123, 8.00000000000023e-05, 8.00000000000023e-05, 8.00000000000023e-05]]
yerr = [[0.003299454500368193, 0.029329466411784594, 0.01254470406187406, 0.011240213521103576, 0.007799487162628069, 0.0017906423428479586, 0.0007332121111929237, 0.0002400000000000069, 0.0002400000000000069], [0.0062179096165833805, 0.05062451580015357, 0.04064094487090575, 0.03230019194989405, 0.025613121637160903, 0.01762997447530768, 0.010361775909563001, 0.0074382793709298215, 0.005034918072819033], [0.008994576143432215, 0.026260114241944948, 0.01192080534192216, 0.010690107576633634, 0.006499230723708775, 0.0016876018487783306, 0.0002400000000000069, 0.0002400000000000069, 0.0002400000000000069]]
line_plot(x, y,['Ours','No replica','Optimal'],colors,
		'/home/bo/Dropbox/Research/SIGCOMM23/images/FCC_fr.eps',
		'Deadline','Failure Rate',
		yerr=yerr)	

# Accuracy and latency stats...
# [0.9406000375747681, 0.941100001335144, 0.941100001335144]
# [0.0011340015335008502, 0.0, 0.0]
# [0.21613929396626866, 0.28271853409546926, 0.19917141368525837]
# [0.003975901676187628, 0.014453020599896211, 0.003964869224127908]

# RMLaaS latency breakdown...
# [0.004808944568634033, 0.014331093515785471, 0.0002481185150146484, 0.19675113736683586]
# [0.00024499675375811824, 0.0010988247132831224, 0.00012197892060241788, 0.07779768257052204]

# recorded trace
# Accuracy and latency stats...
# [0.9410799741744995, 0.941100001335144, 0.941100001335144]
# [0.0016827452927827835, 0.0, 0.0]
# [0.2654680076834863, 0.26379491827428103, 0.24846732073393302]
# [0.0020120118196991156, 0.008957693161860845, 0.002246425085063206]
# Effective accuracy and failure rate...
# [[0.10000000894069672, 0.10000000894069672, 0.9300359487533569, 0.9386560320854187, 0.9409359693527222, 0.9410799741744995, 0.9410799741744995, 0.9410799741744995, 0.9410799741744995], [0.10000000894069672, 0.10000000894069672, 0.8725320100784302, 0.905206024646759, 0.9361221194267273, 0.9404900670051575, 0.9408420324325562, 0.9408420324325562, 0.9408420324325562], [0.10000000894069672, 0.10000000894069672, 0.9303420186042786, 0.9394200444221497, 0.9409559965133667, 0.941100001335144, 0.941100001335144, 0.941100001335144, 0.941100001335144]]
# [[0.0, 0.0, 0.009406824596226215, 0.0027698655612766743, 0.0017431075684726238, 0.0016827452927827835, 0.0016827452927827835, 0.0016827452927827835, 0.0016827452927827835], [0.0, 0.0, 0.04555065557360649, 0.02613610401749611, 0.003540009493008256, 0.0007924546371214092, 0.0004212858038954437, 0.0004212858038954437, 0.0004212858038954437], [0.0, 0.0, 0.00892842561006546, 0.0018226713873445988, 0.0002880096435546875, 0.0, 0.0, 0.0, 0.0]]
# [[1.0, 1.0, 0.013360000000000006, 0.002960000000000007, 0.0001600000000000046, 0.0, 0.0, 0.0, 0.0], [1.0, 1.0, 0.08192, 0.04296, 0.005920000000000003, 0.0008000000000000119, 0.0003200000000000092, 0.0003200000000000092, 0.0003200000000000092], [1.0, 1.0, 0.012719999999999987, 0.002000000000000013, 0.0001600000000000046, 0.0, 0.0, 0.0, 0.0]]
# [[0.0, 0.0, 0.011177405781307223, 0.0028855502074994167, 0.0003200000000000092, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.05438140858786209, 0.0315042600293992, 0.004190656273186806, 0.001011928851253884, 0.0005306599664568792, 0.0005306599664568792, 0.0005306599664568792], [0.0, 0.0, 0.010506835870041928, 0.0021835750502329984, 0.0003200000000000092, 0.0, 0.0, 0.0, 0.0]]
# RMLaaS latency breakdown...
# [0.0048025878143310545, 0.014182490443612923, 0.00024766624450683596, 0.24623526318103583]
# [0.0002416513185180934, 0.00118983579306591, 0.00011602468315707328, 0.0137988335408813]
